# 质量指标 (Quality Metrics)

**最后更新**: 2025-11-30
**数据周期**: 周度更新

---

## 概述

本文档定义了项目的质量指标体系，用于跟踪和改进项目质量。

---

## 1. 代码质量指标

### 1.1 测试覆盖率

| 模块 | 目标 | 当前 | 趋势 |
|------|------|------|------|
| user-service | 80% | 85% | ↑ |
| order-service | 80% | 78% | → |
| product-service | 80% | 82% | ↑ |
| payment-service | 85% | 88% | ↑ |
| **整体** | **80%** | **83%** | ↑ |

### 1.2 代码复杂度

| 指标 | 目标 | 当前 |
|------|------|------|
| 平均圈复杂度 | ≤ 10 | 8.5 |
| 最大圈复杂度 | ≤ 15 | 12 |
| 重复代码率 | ≤ 5% | 3.2% |

### 1.3 静态分析

| 工具 | 问题数 | 趋势 |
|------|--------|------|
| SonarQube Bugs | 5 | ↓ |
| SonarQube Vulnerabilities | 0 | → |
| SonarQube Code Smells | 23 | ↓ |

---

## 2. 发布质量指标

### 2.1 发布频率

| 指标 | 目标 | 当前 |
|------|------|------|
| 发布次数/周 | ≥ 2 | 3 |
| 发布成功率 | ≥ 95% | 97% |
| 平均发布时间 | ≤ 30min | 25min |

### 2.2 回滚率

| 月份 | 发布次数 | 回滚次数 | 回滚率 |
|------|----------|----------|--------|
| 2025-09 | 12 | 1 | 8.3% |
| 2025-10 | 14 | 0 | 0% |
| 2025-11 | 11 | 1 | 9.1% |

**目标**: 回滚率 ≤ 5%

---

## 3. 缺陷指标

### 3.1 缺陷趋势

| 月份 | 新增 | 关闭 | 累计未关闭 |
|------|------|------|------------|
| 2025-09 | 15 | 18 | 12 |
| 2025-10 | 12 | 14 | 10 |
| 2025-11 | 8 | 11 | 7 |

### 3.2 缺陷分布

| 严重程度 | 数量 | 目标 |
|----------|------|------|
| Critical | 0 | 0 |
| High | 2 | ≤ 3 |
| Medium | 5 | ≤ 10 |
| Low | 3 | - |

### 3.3 缺陷逃逸率

**定义**: 上线后发现的缺陷 / 总缺陷

| 月份 | 逃逸率 | 目标 |
|------|--------|------|
| 2025-09 | 8% | ≤ 10% |
| 2025-10 | 5% | ≤ 10% |
| 2025-11 | 6% | ≤ 10% |

---

## 4. 性能指标

### 4.1 API响应时间

| 服务 | P50 | P95 | P99 | 目标 |
|------|-----|-----|-----|------|
| user-service | 15ms | 45ms | 120ms | P99 < 200ms |
| order-service | 25ms | 80ms | 180ms | P99 < 200ms |
| product-service | 20ms | 60ms | 150ms | P99 < 200ms |

### 4.2 系统可用性

| 服务 | 可用性 | 目标 |
|------|--------|------|
| user-service | 99.95% | 99.9% |
| order-service | 99.92% | 99.9% |
| product-service | 99.97% | 99.9% |
| **整体** | **99.93%** | **99.9%** |

---

## 5. AI协作指标

### 5.1 AI代码生成效率

| 指标 | 目标 | 当前 |
|------|------|------|
| AI代码采纳率 | ≥ 60% | 65% |
| AI代码修改率 | ≤ 30% | 25% |
| AI辅助开发占比 | - | 35% |

### 5.2 AI质量指标

| 指标 | 目标 | 当前 |
|------|------|------|
| AI代码通过Review率 | ≥ 80% | 85% |
| AI代码导致的Bug | ≤ 5% | 3% |

---

## 6. 指标看板

### Grafana Dashboard

- [质量指标总览](https://grafana.example.com/d/quality-overview)
- [代码覆盖率趋势](https://grafana.example.com/d/coverage-trend)
- [缺陷分析](https://grafana.example.com/d/defect-analysis)

### 数据来源

| 指标类型 | 数据源 |
|----------|--------|
| 代码覆盖率 | JaCoCo + SonarQube |
| 静态分析 | SonarQube |
| 发布数据 | GitHub Actions |
| 缺陷数据 | Jira |
| 性能数据 | Prometheus |

---

## 7. 改进计划

### 当前焦点

| 指标 | 当前 | 目标 | 改进措施 |
|------|------|------|----------|
| order-service覆盖率 | 78% | 80% | 补充Service层测试 |
| 回滚率 | 9.1% | 5% | 加强staging测试 |

### 下季度目标

1. 整体测试覆盖率提升到85%
2. P99响应时间优化到150ms
3. 缺陷逃逸率降低到5%

---

## 变更历史

| 日期 | 变更 | 作者 |
|------|------|------|
| 2025-11-30 | 初始版本 | @质量负责人 |
